(this.webpackJsonphexjs=this.webpackJsonphexjs||[]).push([[0],{2:function(e,t,i){e.exports={status:"game_status__2JA7C",statusRef:"game_statusRef__2spNS",red:"game_red__AsdVU",blue:"game_blue__2EDZp",container:"game_container__2ViGJ",controlsContainer:"game_controlsContainer__3hr-m",controls:"game_controls__2ZQJd",undoButtons:"game_undoButtons__2p-VW"}},20:function(e,t,i){"use strict";i.r(t);var s=i(3),a=i.n(s),r=i(14),h=i.n(r),n=i(1),c=i(4),o=i(5),l=i(9),u=i(8),v=i(7),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:11,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:11;Object(c.a)(this,e),this.WIDTH=t,this.HEIGHT=i,this.currentPlayer=1,this.gameOver=!1,this.winner=0,this.board=new Array(this.HEIGHT),this.searched=new Array(this.HEIGHT),this.searchedQueue=[];for(var s=0;s<this.HEIGHT;s++)this.board[s]=new Array(this.WIDTH).fill(0),this.searched[s]=new Array(this.WIDTH).fill(!1);this.moveHistory=[]}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e(this.WIDTH,this.HEIGHT);t.currentPlayer=this.currentPlayer,t.gameOver=this.gameOver,t.winner=this.winner;var i,s=Object(v.a)(this.moveHistory);try{for(s.s();!(i=s.n()).done;){var a=i.value;t.board[a[0]][a[1]]=this.board[a[0]][a[1]],t.moveHistory.push(Object(n.a)(a))}}catch(r){s.e(r)}finally{s.f()}return t}},{key:"move",value:function(e,t){return!(0!==this.board[e][t]||this.gameOver||!this.inBound(e,t))&&(this.board[e][t]=this.currentPlayer,this.moveHistory.push([e,t]),this.findWin(e,t)&&(this.winner=this.currentPlayer,this.gameOver=!0),this.currentPlayer*=-1,!0)}},{key:"undo",value:function(){var e=this.moveHistory.pop();e&&(this.gameOver=!1,this.currentPlayer*=-1,this.winner=0,this.board[e[0]][e[1]]=0)}},{key:"findConnection",value:function(e,t,i){var s,a=this.dfs(e,t,i),r=Object(v.a)(this.searchedQueue);try{for(r.s();!(s=r.n()).done;){var h=s.value;this.searched[h[0]][h[1]]=!1}}catch(n){r.e(n)}finally{r.f()}return this.searchedQueue=[],a}},{key:"dfs",value:function(e,t,i){if(this.visited++,!this.inBound(e,t)||this.board[e][t]!==this.currentPlayer)return!1;if(i(e,t))return!0;var s=!1,a=this.neighbors(e,t);this.searched[e][t]=!0,this.searchedQueue.push([e,t]);var r,h=Object(v.a)(a);try{for(h.s();!(r=h.n()).done;){var c=r.value;if(this.inBound.apply(this,Object(n.a)(c))&&!this.searched[c[0]][c[1]]&&this.dfs.apply(this,Object(n.a)(c).concat([i]))){s=!0;break}}}catch(o){h.e(o)}finally{h.f()}return s}},{key:"inBound",value:function(e,t){return e>=0&&t>=0&&e<this.HEIGHT&&t<this.WIDTH}},{key:"neighbors",value:function(e,t){return[[e-1,t],[e-1,t+1],[e,t+1],[e+1,t],[e+1,t-1],[e,t-1]]}},{key:"connectTop",value:function(e,t){return e<=0}},{key:"connectBottom",value:function(e,t){return e>=this.HEIGHT-1}},{key:"connectLeft",value:function(e,t){return t<=0}},{key:"connectRight",value:function(e,t){return t>=this.WIDTH-1}},{key:"findWin",value:function(e,t){var i,s,a=this;if(Math.ceil(this.moveHistory.length/2)<(this.currentPlayer>0?this.HEIGHT:this.WIDTH))return!1;this.currentPlayer>0?(i=function(e,t){return a.connectTop(e,t)},s=function(e,t){return a.connectBottom(e,t)}):(i=function(e,t){return a.connectLeft(e,t)},s=function(e,t){return a.connectRight(e,t)});var r=this.findConnection(e,t,i);if(!r)return!1;var h=this.findConnection(e,t,s);return r&&h}}]),e}(),f=i(12),b=i(6),x=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e,s){return Object(c.a)(this,i),t.call(this,e,s)}return Object(o.a)(i,[{key:"move",value:function(e,t){var s=this.gameOver;Object(f.a)(Object(b.a)(i.prototype),"move",this).call(this,e,t),s!=this.gameOver&&(this.winner*=-1)}},{key:"copy",value:function(){var e=new i(this.WIDTH,this.HEIGHT);e.currentPlayer=this.currentPlayer,e.gameOver=this.gameOver,e.winner=this.winner;var t,s=Object(v.a)(this.moveHistory);try{for(s.s();!(t=s.n()).done;){var a=t.value;e.board[a[0]][a[1]]=this.board[a[0]][a[1]],e.moveHistory.push(Object(n.a)(a))}}catch(r){s.e(r)}finally{s.f()}return e}}]),i}(d),m=i(2),j=i.n(m),y=function(){function e(t){Object(c.a)(this,e),this.hex=t}return Object(o.a)(e,[{key:"move",value:function(){var e,t,i=[];t=this.hex.view?this.hex.view[this.hex.currentPlayer]:this.hex.board;for(var s=0;s<this.hex.HEIGHT;s++)for(var a=0;a<this.hex.WIDTH;a++)t[s][a]||i.push([s,a]);i.length&&(e=this.hex).move.apply(e,Object(n.a)(i[Math.floor(Math.random()*i.length)]))}}]),e}();Array.prototype.shuffle=function(){for(var e=0;e<this.length;e++){var t=Math.floor(Math.random()*(e+1)),i=[this[t],this[e]];this[e]=i[0],this[t]=i[1]}};var g=1,O=-1,p=0,w=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(Object(c.a)(this,e),this.parent=i,this.wins=0,this.games=0,this.moveIndex=s,this.hex=t.copy(),this.childMoves=[],this.children=[],this.status=p,t.gameOver&&(this.status=g),!this.hex.gameOver){for(var a=0;a<this.hex.HEIGHT;a++)for(var r=0;r<this.hex.WIDTH;r++)0===this.hex.board[a][r]&&this.childMoves.push([a,r]);this.childMoves.shuffle()}}return Object(o.a)(e,[{key:"isLeaf",value:function(){return 0===this.childMoves.length}},{key:"evaluate",value:function(){return this.status==p?this.wins/this.games+Math.sqrt(Math.log(this.parent.games)/this.games):1/0*this.status}},{key:"select",value:function(){if(0===this.children.length||this.children.length<this.childMoves.length)return this;var e,t=this.children[0],i=Object(v.a)(this.children);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.evaluate()>t.evaluate()&&(t=s)}}catch(a){i.e(a)}finally{i.f()}return t.select()}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;if(this.children.length!==this.childMoves.length){var i=this.childMoves[this.children.length],s=this.hex.copy();s.move.apply(s,Object(n.a)(i));var a=new e(s,this,i);this.children.push(a),a.status===g&&(this.status=O);for(var r=0;r<t;r++)a.backpropagate(a.simulate());return a}for(var h=0;h<t;h++)this.backpropagate(this.simulate())}},{key:"simulate",value:function(){var e=Object(n.a)(this.childMoves);e.shuffle();for(var t=0;t<=e.length;t++){var i;if(this.hex.gameOver){for(var s=this.hex.winner,a=0;a<t;a++)this.hex.undo();return s}(i=this.hex).move.apply(i,Object(n.a)(e[t]))}}},{key:"backpropagate",value:function(e){this.games++,void 0!==this.parent&&(this.wins+=e===this.parent.hex.currentPlayer,this.parent.backpropagate(e))}}]),e}(),k=function(){function e(t){Object(c.a)(this,e),this.hex=t,this.rootNode=new w(t)}return Object(o.a)(e,[{key:"bestMove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;if(!this.rootNode.gameOver){for(;e--;){var t=this.rootNode.select();t.expand()}var i,s=this.rootNode.children[0],a=Object(v.a)(this.rootNode.children);try{for(a.s();!(i=a.n()).done;){var r=i.value;r.games>s.games&&(s=r)}}catch(h){a.e(h)}finally{a.f()}return console.log(this.rootNode),s.moveIndex}}},{key:"move",value:function(){var e,t=(new Date).getTime(),i=this.bestMove();(e=this.hex).move.apply(e,Object(n.a)(i)),t=(new Date).getTime()-t,console.log(t+"ms")}}]),e}(),H=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e,s){var a;Object(c.a)(this,i),(a=t.call(this,e,s)).view=[],a.view[-1]=new Array(s),a.view[1]=new Array(s);for(var r=0;r<s;r++)a.view[-1][r]=new Array(e).fill(0),a.view[1][r]=new Array(e).fill(0);return a}return Object(o.a)(i,[{key:"copy",value:function(){var e=new d(this.WIDTH,this.HEIGHT);e.currentPlayer=this.currentPlayer,e.gameOver=this.gameOver,e.winner=this.winner;for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++)e.board[t][i]=this.view[this.currentPlayer][t][i];return e}},{key:"move",value:function(e,t){if(!this.gameOver&&this.inBound(e,t)){var s=!Object(f.a)(Object(b.a)(i.prototype),"move",this).call(this,e,t);s||(this.currentPlayer*=-1),this.view[this.currentPlayer][e][t]=this.board[e][t],s||(this.currentPlayer*=-1)}}}]),i}(d),R=i(0),I=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e){var s;return Object(c.a)(this,i),(s=t.call(this,e)).canvasRef=a.a.createRef(),s.statusRef=a.a.createRef(),s.statusRef2=a.a.createRef(),s.modeRef=a.a.createRef(),s.heightRef=a.a.createRef(),s.widthRef=a.a.createRef(),s.redRef=a.a.createRef(),s.blueRef=a.a.createRef(),s}return Object(o.a)(i,[{key:"isInteger",value:function(e){for(var t=0;t<e.length;t++)if(!"0123456789".includes(e[t]))return!1;return e.length>0&&0!==parseInt(e)}},{key:"componentDidMount",value:function(){var e=this;this.canvas=this.canvasRef.current,this.ctx=this.canvas.getContext("2d"),this.WHITE=[255,255,255],this.BLACK=[0,0,0],this.RED=[255,0,0],this.BLUE=[0,0,255],this.interval=setInterval((function(){e.update(),e.draw()}),1e3/30);var t=this;this.canvas.addEventListener("click",(function(e){var i=t.canvas.getBoundingClientRect(),s=t.canvas.width/i.width,a=t.canvas.height/i.height,r=s*(e.clientX-i.left),h=a*(e.clientY-i.top);t.mousePressed(r,h)}))}},{key:"startGame",value:function(){if(this.isInteger(this.heightRef.current.value)&&this.isInteger(this.widthRef.current.value)){this.aiRed=this.redRef.current.value,this.aiBlue=this.blueRef.current.value;var e=parseInt(this.heightRef.current.value),t=parseInt(this.widthRef.current.value);switch(this.mode=this.modeRef.current.value,this.mode){case"normal":this.hex=new d(t,e);break;case"anti":this.hex=new x(t,e);break;case"dark":this.hex=new H(t,e)}this.hexagons=new Array(this.hex.HEIGHT),this.cellSize=this.canvas.width/(1.5*Math.max(this.hex.WIDTH,this.hex.HEIGHT)*2);for(var i=0;i<this.hex.HEIGHT;i++){this.hexagons[i]=new Array(this.hex.WIDTH);for(var s=0;s<this.hex.WIDTH;s++){this.hexagons[i][s]=[];for(var a=this.getCenter(i,s),r=0;r<6;r++){var h=r*Math.PI/3+Math.PI/2;this.hexagons[i][s].push([a[0]+this.cellSize*Math.cos(h),a[1]-this.cellSize*Math.sin(h)])}}}this.draw()}}},{key:"getCenter",value:function(e,t){var i=Math.sin(Math.PI/3);return[1.5*this.cellSize+e*this.cellSize*i+2*t*this.cellSize*i,1.5*this.cellSize+e*this.cellSize*3/2]}},{key:"drawCell",value:function(e,t){this.ctx.strokeStyle="black",this.ctx.lineWidth=2;var i=this.hexagons[e][t];this.ctx.beginPath();for(var s=0;s<6;s++){var a,r;(a=this.ctx).moveTo.apply(a,Object(n.a)(i[s])),(r=this.ctx).lineTo.apply(r,Object(n.a)(i[(s+1)%6]))}this.ctx.stroke(),this.ctx.lineWidth=5;for(var h=0;h<6;h++){var c,o,l,u,v=[[i[h][0],i[h][1]],[i[(h+1)%6][0],i[(h+1)%6][1]]],d=0===e&&(0===h||5===h),f=e===this.hex.HEIGHT-1&&(2===h||3===h),b=0===t&&(1===h||2===h),x=t===this.hex.WIDTH-1&&(4===h||5===h);if(d||f)this.ctx.strokeStyle="red",this.ctx.beginPath(),(c=this.ctx).moveTo.apply(c,Object(n.a)(v[0])),(o=this.ctx).lineTo.apply(o,Object(n.a)(v[1])),this.ctx.stroke();if(b||x)this.ctx.strokeStyle="blue",this.ctx.beginPath(),(l=this.ctx).moveTo.apply(l,Object(n.a)(v[0])),(u=this.ctx).lineTo.apply(u,Object(n.a)(v[1])),this.ctx.stroke()}}},{key:"draw",value:function(){if(this.updatePlayer(),this.hex){var e;this.ctx.fillStyle="white",this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.fill(),e="dark"==this.mode?"manual"==this.aiRed&&this.aiRed!=this.aiBlue?this.hex.view[1]:"manual"==this.aiBlue&&this.aiRed!=this.aiBlue?this.hex.view[-1]:this.hex.view[this.hex.currentPlayer]:this.hex.board;for(var t=0;t<this.hex.HEIGHT;t++)for(var i=0;i<this.hex.WIDTH;i++){this.ctx.fillStyle="white",this.drawCell(t,i);var s,a=this.getCenter(t,i),r=void 0;switch(e[t][i]){case 1:r="red";break;case-1:r="blue"}if(this.hex.gameOver&&(this.hex.view[1][t][i]!=this.hex.board[t][i]||this.hex.view[-1][t][i]!=this.hex.board[t][i]))switch(this.hex.board[t][i]){case 1:r="rgba(255, 0, 0, 0.3)";break;case-1:r="rgba(0, 0, 255, 0.3)"}if(r)this.ctx.strokeStyle="black",this.ctx.lineWidth=5,this.ctx.beginPath(),(s=this.ctx).arc.apply(s,Object(n.a)(a).concat([this.cellSize/2,0,2*Math.PI])),this.ctx.stroke(),this.ctx.fillStyle=r,this.ctx.fill()}}}},{key:"updatePlayer",value:function(){var e=this.statusRef.current,t=this.statusRef2.current;this.hex?this.hex.gameOver?(e.textContent="".concat(this.hex.winner>0?"Red":"Blue"),t.textContent=" Wins",this.hex.winner>0?(e.classList.remove(j.a.blue),e.classList.add(j.a.red)):(e.classList.remove(j.a.red),e.classList.add(j.a.blue))):(e.textContent="".concat(this.hex.currentPlayer>0?"Red":"Blue"),t.textContent="'s Turn",this.hex.currentPlayer>0?(e.classList.remove(j.a.blue),e.classList.add(j.a.red)):(e.classList.remove(j.a.red),e.classList.add(j.a.blue))):e.textContent=t.textContent=""}},{key:"update",value:function(){this.move()}},{key:"move",value:function(){if(this.hex&&!this.hex.gameOver){var e,t=1==this.hex.currentPlayer?this.aiRed:this.aiBlue;if("manual"!==t){switch(t){case"random":e=y;break;case"mcts":e=k}new e(this.hex).move()}else{var i;this.manualMove&&((i=this.hex).move.apply(i,Object(n.a)(this.manualMove)),this.manualMove=null)}}}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.hex)for(var t=0;t<e;t++)this.hex.undo()}},{key:"getCell",value:function(e,t){if(this.hex)for(var i=0;i<this.hex.HEIGHT;i++)for(var s=0;s<this.hex.WIDTH;s++){var a=this.getCenter(i,s);if(Math.pow(e-a[0],2)+Math.pow(t-a[1],2)<=3/4*Math.pow(this.cellSize,2))return[i,s]}}},{key:"mousePressed",value:function(e,t){var i=this.getCell(e,t);void 0===i||this.hex.gameOver||(this.manualMove=i)}},{key:"render",value:function(){var e=this;return Object(R.jsxs)("div",{class:j.a.container,children:[Object(R.jsx)("div",{class:j.a.controlsContainer,children:Object(R.jsxs)("div",{class:j.a.controls,children:[Object(R.jsx)("h1",{children:"Hex"}),Object(R.jsx)("h2",{children:"Aaron He"}),Object(R.jsx)("label",{for:"mode",children:"Mode:"}),Object(R.jsxs)("select",{name:"mode",id:"mode",ref:this.modeRef,children:[Object(R.jsx)("option",{value:"normal",children:"Normal"}),Object(R.jsx)("option",{value:"anti",children:"Anti Hex"}),Object(R.jsx)("option",{value:"dark",children:"Dark Hex"})]}),Object(R.jsx)("br",{}),Object(R.jsx)("label",{for:"height",children:"Height:"}),Object(R.jsx)("input",{type:"number",min:"1",name:"height",id:"height",ref:this.heightRef,defaultValue:"6"}),Object(R.jsx)("label",{for:"width",children:"Width:"}),Object(R.jsx)("input",{type:"number",min:"1",name:"width",id:"width",ref:this.widthRef,defaultValue:"6"}),Object(R.jsx)("br",{}),Object(R.jsx)("label",{for:"red",children:"Red:"}),Object(R.jsxs)("select",{name:"red",id:"red",ref:this.redRef,children:[Object(R.jsx)("option",{value:"manual",children:"Manual"}),Object(R.jsx)("option",{value:"random",children:"Random"}),Object(R.jsx)("option",{value:"mcts",children:"MCTS"})]}),Object(R.jsx)("label",{for:"blue",children:"Blue:"}),Object(R.jsxs)("select",{name:"blue",id:"blue",ref:this.blueRef,children:[Object(R.jsx)("option",{value:"manual",children:"Manual"}),Object(R.jsx)("option",{value:"random",children:"Random"}),Object(R.jsx)("option",{value:"mcts",children:"MCTS"})]}),Object(R.jsx)("br",{}),Object(R.jsx)("button",{onClick:function(){return e.startGame()},children:"Start game"}),Object(R.jsx)("br",{}),Object(R.jsxs)("div",{class:j.a.undoButtons,children:[Object(R.jsx)("button",{onClick:function(){return e.undo()},class:j.a.undoButton,children:"Undo"}),Object(R.jsx)("button",{onClick:function(){return e.undo(2)},children:"Undo 2"})]})]})}),Object(R.jsxs)("div",{class:j.a.game,children:[Object(R.jsx)("span",{ref:this.statusRef,className:"".concat(j.a.status," ").concat(j.a.statusRef)}),Object(R.jsx)("span",{ref:this.statusRef2,className:j.a.status}),Object(R.jsx)("br",{}),Object(R.jsx)("canvas",{ref:this.canvasRef,width:"2400",height:"1600",style:{width:"70vw"}})]})]})}}]),i}(s.Component);var T=function(){return Object(R.jsx)(I,{})};h.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(T,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.92e88793.chunk.js.map