(this.webpackJsonphexjs=this.webpackJsonphexjs||[]).push([[0],{2:function(e,t,i){e.exports={status:"game_status__2JA7C",statusRef:"game_statusRef__2spNS",red:"game_red__AsdVU",blue:"game_blue__2EDZp",container:"game_container__2ViGJ",controlsContainer:"game_controlsContainer__3hr-m",controls:"game_controls__2ZQJd",undoButtons:"game_undoButtons__2p-VW"}},20:function(e,t,i){"use strict";i.r(t);var s=i(3),a=i.n(s),n=i(13),r=i.n(n),h=i(1),c=i(4),o=i(5),l=i(11),u=i(10),v=i(6),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:11,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:11;Object(c.a)(this,e),this.WIDTH=t,this.HEIGHT=i,this.currentPlayer=1,this.gameOver=!1,this.winner=0,this.board=new Array(this.HEIGHT),this.searched=new Array(this.HEIGHT),this.searchedQueue=[];for(var s=0;s<this.HEIGHT;s++)this.board[s]=new Array(this.WIDTH).fill(0),this.searched[s]=new Array(this.WIDTH).fill(!1);this.moveHistory=[]}return Object(o.a)(e,[{key:"copy",value:function(){var t=new e(this.WIDTH,this.HEIGHT);t.currentPlayer=this.currentPlayer,t.gameOver=this.gameOver,t.winner=this.winner;var i,s=Object(v.a)(this.moveHistory);try{for(s.s();!(i=s.n()).done;){var a=i.value;t.board[a[0]][a[1]]=this.board[a[0]][a[1]],t.moveHistory.push(Object(h.a)(a))}}catch(n){s.e(n)}finally{s.f()}return t}},{key:"move",value:function(e,t){if(0!==this.board[e][t]||this.gameOver||!this.inBound(e,t))return!1;this.board[e][t]=this.currentPlayer,this.moveHistory.push([e,t]),this.findWin(e,t)&&(this.winner=this.currentPlayer,this.gameOver=!0),this.currentPlayer*=-1}},{key:"undo",value:function(){var e=this.moveHistory.pop();e&&(this.gameOver=!1,this.currentPlayer*=-1,this.winner=0,this.board[e[0]][e[1]]=0)}},{key:"findConnection",value:function(e,t,i){var s,a=this.dfs(e,t,i),n=Object(v.a)(this.searchedQueue);try{for(n.s();!(s=n.n()).done;){var r=s.value;this.searched[r[0]][r[1]]=!1}}catch(h){n.e(h)}finally{n.f()}return this.searchedQueue=[],a}},{key:"dfs",value:function(e,t,i){if(this.visited++,!this.inBound(e,t)||this.board[e][t]!==this.currentPlayer)return!1;if(i(e,t))return!0;var s=!1,a=this.neighbors(e,t);this.searched[e][t]=!0,this.searchedQueue.push([e,t]);var n,r=Object(v.a)(a);try{for(r.s();!(n=r.n()).done;){var c=n.value;if(this.inBound.apply(this,Object(h.a)(c))&&!this.searched[c[0]][c[1]]&&this.dfs.apply(this,Object(h.a)(c).concat([i]))){s=!0;break}}}catch(o){r.e(o)}finally{r.f()}return s}},{key:"inBound",value:function(e,t){return e>=0&&t>=0&&e<this.HEIGHT&&t<this.WIDTH}},{key:"neighbors",value:function(e,t){return[[e-1,t],[e-1,t+1],[e,t+1],[e+1,t],[e+1,t-1],[e,t-1]]}},{key:"connectTop",value:function(e,t){return e<=0}},{key:"connectBottom",value:function(e,t){return e>=this.HEIGHT-1}},{key:"connectLeft",value:function(e,t){return t<=0}},{key:"connectRight",value:function(e,t){return t>=this.WIDTH-1}},{key:"findWin",value:function(e,t){var i,s,a=this;if(Math.ceil(this.moveHistory.length/2)<(this.currentPlayer>0?this.HEIGHT:this.WIDTH))return!1;this.currentPlayer>0?(i=function(e,t){return a.connectTop(e,t)},s=function(e,t){return a.connectBottom(e,t)}):(i=function(e,t){return a.connectLeft(e,t)},s=function(e,t){return a.connectRight(e,t)});var n=this.findConnection(e,t,i);if(!n)return!1;var r=this.findConnection(e,t,s);return n&&r}}]),e}(),f=i(14),b=i(7),x=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e,s){return Object(c.a)(this,i),t.call(this,e,s)}return Object(o.a)(i,[{key:"move",value:function(e,t){var s=this.gameOver;Object(f.a)(Object(b.a)(i.prototype),"move",this).call(this,e,t),s!=this.gameOver&&(this.winner*=-1)}},{key:"copy",value:function(){var e=new i(this.WIDTH,this.HEIGHT);e.currentPlayer=this.currentPlayer,e.gameOver=this.gameOver,e.winner=this.winner;var t,s=Object(v.a)(this.moveHistory);try{for(s.s();!(t=s.n()).done;){var a=t.value;e.board[a[0]][a[1]]=this.board[a[0]][a[1]],e.moveHistory.push(Object(h.a)(a))}}catch(n){s.e(n)}finally{s.f()}return e}}]),i}(d),j=i(2),m=i.n(j),y=function(){function e(t){Object(c.a)(this,e),this.hex=t}return Object(o.a)(e,[{key:"move",value:function(){for(var e,t=[],i=0;i<this.hex.HEIGHT;i++)for(var s=0;s<this.hex.WIDTH;s++)this.hex.board[i][s]||t.push([i,s]);t.length&&(e=this.hex).move.apply(e,Object(h.a)(t[Math.floor(Math.random()*t.length)]))}}]),e}();Array.prototype.shuffle=function(){for(var e=0;e<this.length;e++){var t=Math.floor(Math.random()*(e+1)),i=[this[t],this[e]];this[e]=i[0],this[t]=i[1]}};var g=1,p=-1,O=0,H=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(Object(c.a)(this,e),this.parent=i,this.wins=0,this.games=0,this.moveIndex=s,this.hex=t.copy(),this.childMoves=[],this.children=[],this.status=O,t.gameOver&&(this.status=g),!this.hex.gameOver){for(var a=0;a<this.hex.HEIGHT;a++)for(var n=0;n<this.hex.WIDTH;n++)0===this.hex.board[a][n]&&this.childMoves.push([a,n]);this.childMoves.shuffle()}}return Object(o.a)(e,[{key:"isLeaf",value:function(){return 0===this.childMoves.length}},{key:"evaluate",value:function(){return this.status==O?this.wins/this.games+Math.sqrt(Math.log(this.parent.games)/this.games):1/0*this.status}},{key:"select",value:function(){if(0===this.children.length||this.children.length<this.childMoves.length)return this;var e,t=this.children[0],i=Object(v.a)(this.children);try{for(i.s();!(e=i.n()).done;){var s=e.value;s.evaluate()>t.evaluate()&&(t=s)}}catch(a){i.e(a)}finally{i.f()}return t.select()}},{key:"expand",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;if(this.children.length!==this.childMoves.length){var i=this.childMoves[this.children.length],s=this.hex.copy();s.move.apply(s,Object(h.a)(i));var a=new e(s,this,i);this.children.push(a),a.status===g&&(this.status=p);for(var n=0;n<t;n++)a.backpropagate(a.simulate());return a}for(var r=0;r<t;r++)this.backpropagate(this.simulate())}},{key:"simulate",value:function(){var e=Object(h.a)(this.childMoves);e.shuffle();for(var t=0;t<=e.length;t++){var i;if(this.hex.gameOver){for(var s=this.hex.winner,a=0;a<t;a++)this.hex.undo();return s}(i=this.hex).move.apply(i,Object(h.a)(e[t]))}}},{key:"backpropagate",value:function(e){this.games++,void 0!==this.parent&&(this.wins+=e===this.parent.hex.currentPlayer,this.parent.backpropagate(e))}}]),e}(),k=function(){function e(t){Object(c.a)(this,e),this.hex=t,console.log(t),this.rootNode=new H(t),console.log(t),console.log(this.rootNode.hex)}return Object(o.a)(e,[{key:"bestMove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e3;if(!this.rootNode.gameOver){for(;e--;){var t=this.rootNode.select();t.expand()}var i,s=this.rootNode.children[0],a=Object(v.a)(this.rootNode.children);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.games>s.games&&(s=n)}}catch(r){a.e(r)}finally{a.f()}return console.log(this.rootNode),s.moveIndex}}},{key:"move",value:function(){var e,t=(new Date).getTime(),i=this.bestMove();(e=this.hex).move.apply(e,Object(h.a)(i)),t=(new Date).getTime()-t,console.log(t+"ms")}}]),e}(),w=i(0),I=function(e){Object(l.a)(i,e);var t=Object(u.a)(i);function i(e){var s;return Object(c.a)(this,i),(s=t.call(this,e)).canvasRef=a.a.createRef(),s.statusRef=a.a.createRef(),s.statusRef2=a.a.createRef(),s.modeRef=a.a.createRef(),s.heightRef=a.a.createRef(),s.widthRef=a.a.createRef(),s.redRef=a.a.createRef(),s.blueRef=a.a.createRef(),s}return Object(o.a)(i,[{key:"isInteger",value:function(e){for(var t=0;t<e.length;t++)if(!"0123456789".includes(e[t]))return!1;return e.length>0&&0!==parseInt(e)}},{key:"componentDidMount",value:function(){var e=this;this.canvas=this.canvasRef.current,this.ctx=this.canvas.getContext("2d"),this.WHITE=[255,255,255],this.BLACK=[0,0,0],this.RED=[255,0,0],this.BLUE=[0,0,255],this.interval=setInterval((function(){e.update(),e.draw()}),1e3/30);var t=this;this.canvas.addEventListener("click",(function(e){var i=t.canvas.getBoundingClientRect(),s=t.canvas.width/i.width,a=t.canvas.height/i.height,n=s*(e.clientX-i.left),r=a*(e.clientY-i.top);t.mousePressed(n,r)}))}},{key:"startGame",value:function(){if(this.isInteger(this.heightRef.current.value)&&this.isInteger(this.widthRef.current.value)){this.aiRed=this.redRef.current.value,this.aiBlue=this.blueRef.current.value;var e=parseInt(this.heightRef.current.value),t=parseInt(this.widthRef.current.value);switch(this.modeRef.current.value){case"normal":this.hex=new d(t,e);break;case"anti":this.hex=new x(t,e)}this.hexagons=new Array(this.hex.HEIGHT),this.cellSize=this.canvas.width/(1.5*Math.max(this.hex.WIDTH,this.hex.HEIGHT)*2);for(var i=0;i<this.hex.HEIGHT;i++){this.hexagons[i]=new Array(this.hex.WIDTH);for(var s=0;s<this.hex.WIDTH;s++){this.hexagons[i][s]=[];for(var a=this.getCenter(i,s),n=0;n<6;n++){var r=n*Math.PI/3+Math.PI/2;this.hexagons[i][s].push([a[0]+this.cellSize*Math.cos(r),a[1]-this.cellSize*Math.sin(r)])}}}this.draw()}}},{key:"getCenter",value:function(e,t){var i=Math.sin(Math.PI/3);return[1.5*this.cellSize+e*this.cellSize*i+2*t*this.cellSize*i,1.5*this.cellSize+e*this.cellSize*3/2]}},{key:"drawCell",value:function(e,t){this.ctx.strokeStyle="black",this.ctx.lineWidth=2;var i=this.hexagons[e][t];this.ctx.beginPath();for(var s=0;s<6;s++){var a,n;(a=this.ctx).moveTo.apply(a,Object(h.a)(i[s])),(n=this.ctx).lineTo.apply(n,Object(h.a)(i[(s+1)%6]))}this.ctx.stroke(),this.ctx.lineWidth=5;for(var r=0;r<6;r++){var c,o,l,u,v=[[i[r][0],i[r][1]],[i[(r+1)%6][0],i[(r+1)%6][1]]],d=0===e&&(0===r||5===r),f=e===this.hex.HEIGHT-1&&(2===r||3===r),b=0===t&&(1===r||2===r),x=t===this.hex.WIDTH-1&&(4===r||5===r);if(d||f)this.ctx.strokeStyle="red",this.ctx.beginPath(),(c=this.ctx).moveTo.apply(c,Object(h.a)(v[0])),(o=this.ctx).lineTo.apply(o,Object(h.a)(v[1])),this.ctx.stroke();if(b||x)this.ctx.strokeStyle="blue",this.ctx.beginPath(),(l=this.ctx).moveTo.apply(l,Object(h.a)(v[0])),(u=this.ctx).lineTo.apply(u,Object(h.a)(v[1])),this.ctx.stroke()}}},{key:"draw",value:function(){if(this.updatePlayer(),this.hex){this.ctx.fillStyle="white",this.ctx.rect(0,0,this.canvas.width,this.canvas.height),this.ctx.fill();for(var e=0;e<this.hex.HEIGHT;e++)for(var t=0;t<this.hex.WIDTH;t++){this.ctx.fillStyle="white",this.drawCell(e,t);var i,s=this.getCenter(e,t),a=void 0;switch(this.hex.board[e][t]){case 1:a="red";break;case-1:a="blue"}if(a)this.ctx.strokeStyle="black",this.ctx.lineWidth=5,this.ctx.beginPath(),(i=this.ctx).arc.apply(i,Object(h.a)(s).concat([this.cellSize/2,0,2*Math.PI])),this.ctx.stroke(),this.ctx.fillStyle=a,this.ctx.fill()}}}},{key:"updatePlayer",value:function(){var e=this.statusRef.current,t=this.statusRef2.current;this.hex?this.hex.gameOver?(e.textContent="".concat(this.hex.winner>0?"Red":"Blue"),t.textContent=" Wins",this.hex.winner>0?(e.classList.remove(m.a.blue),e.classList.add(m.a.red)):(e.classList.remove(m.a.red),e.classList.add(m.a.blue))):(e.textContent="".concat(this.hex.currentPlayer>0?"Red":"Blue"),t.textContent="'s Turn",this.hex.currentPlayer>0?(e.classList.remove(m.a.blue),e.classList.add(m.a.red)):(e.classList.remove(m.a.red),e.classList.add(m.a.blue))):e.textContent=t.textContent=""}},{key:"update",value:function(){this.move()}},{key:"move",value:function(){if(this.hex&&!this.hex.gameOver){var e,t=1==this.hex.currentPlayer?this.aiRed:this.aiBlue;if("manual"!==t){switch(t){case"random":e=y;break;case"mcts":e=k}new e(this.hex).move()}else{var i;this.manualMove&&((i=this.hex).move.apply(i,Object(h.a)(this.manualMove)),this.manualMove=null)}}}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(this.hex)for(var t=0;t<e;t++)this.hex.undo()}},{key:"getCell",value:function(e,t){if(this.hex)for(var i=0;i<this.hex.HEIGHT;i++)for(var s=0;s<this.hex.WIDTH;s++){var a=this.getCenter(i,s);if(Math.pow(e-a[0],2)+Math.pow(t-a[1],2)<=3/4*Math.pow(this.cellSize,2))return[i,s]}}},{key:"mousePressed",value:function(e,t){var i=this.getCell(e,t);void 0===i||this.hex.gameOver||(this.manualMove=i)}},{key:"render",value:function(){var e=this;return Object(w.jsxs)("div",{class:m.a.container,children:[Object(w.jsx)("div",{class:m.a.controlsContainer,children:Object(w.jsxs)("div",{class:m.a.controls,children:[Object(w.jsx)("h1",{children:"Hex"}),Object(w.jsx)("h2",{children:"Aaron He"}),Object(w.jsx)("label",{for:"mode",children:"Mode:"}),Object(w.jsxs)("select",{name:"mode",id:"mode",ref:this.modeRef,children:[Object(w.jsx)("option",{value:"normal",children:"Normal"}),Object(w.jsx)("option",{value:"anti",children:"Anti Hex"})]}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{for:"height",children:"Height:"}),Object(w.jsx)("input",{type:"number",min:"1",name:"height",id:"height",ref:this.heightRef,defaultValue:"6"}),Object(w.jsx)("label",{for:"width",children:"Width:"}),Object(w.jsx)("input",{type:"number",min:"1",name:"width",id:"width",ref:this.widthRef,defaultValue:"6"}),Object(w.jsx)("br",{}),Object(w.jsx)("label",{for:"red",children:"Red:"}),Object(w.jsxs)("select",{name:"red",id:"red",ref:this.redRef,children:[Object(w.jsx)("option",{value:"manual",children:"Manual"}),Object(w.jsx)("option",{value:"random",children:"Random"}),Object(w.jsx)("option",{value:"mcts",children:"MCTS"})]}),Object(w.jsx)("label",{for:"blue",children:"Blue:"}),Object(w.jsxs)("select",{name:"blue",id:"blue",ref:this.blueRef,children:[Object(w.jsx)("option",{value:"manual",children:"Manual"}),Object(w.jsx)("option",{value:"random",children:"Random"}),Object(w.jsx)("option",{value:"mcts",children:"MCTS"})]}),Object(w.jsx)("br",{}),Object(w.jsx)("button",{onClick:function(){return e.startGame()},children:"Start game"}),Object(w.jsx)("br",{}),Object(w.jsxs)("div",{class:m.a.undoButtons,children:[Object(w.jsx)("button",{onClick:function(){return e.undo()},class:m.a.undoButton,children:"Undo"}),Object(w.jsx)("button",{onClick:function(){return e.undo(2)},children:"Undo 2"})]})]})}),Object(w.jsxs)("div",{class:m.a.game,children:[Object(w.jsx)("span",{ref:this.statusRef,className:"".concat(m.a.status," ").concat(m.a.statusRef)}),Object(w.jsx)("span",{ref:this.statusRef2,className:m.a.status}),Object(w.jsx)("br",{}),Object(w.jsx)("canvas",{ref:this.canvasRef,width:"2400",height:"1600",style:{width:"70vw"}})]})]})}}]),i}(s.Component);var R=function(){return Object(w.jsx)(I,{})};r.a.render(Object(w.jsx)(a.a.StrictMode,{children:Object(w.jsx)(R,{})}),document.getElementById("root"))}},[[20,1,2]]]);
//# sourceMappingURL=main.ab3194e9.chunk.js.map